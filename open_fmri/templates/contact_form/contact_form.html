{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% crispy form form.helper %}
{% block title %}
Contact
{% endblock %}
{% block content %}
    <h1>Contact</h1>
    <p>
        Requirements for data set submission to OpenfMRI:
        <br/>
        <ul>
            <li>
            The data when uploaded must be raw and unprocessed. Researchers who 
            wish to share processed data should use 
            <a href="http://neurovault.org">http://neurovault.org</a> 
            instead.
            <br/><br/>
            <input type="checkbox" name="unprocessed" id="unprocessed" required/> 
            The data to be uploaded is raw and unprocessed.
            <br/><br/>
            </li>
            <li>
            The dataset must include some form of brain imaging data. All forms of 
            MRI data are accepted including structural, functional, and diffusion 
            MRI. Electrophysiological data will be accepted if they accompany a
            MRI dataset.
            <br/><br/>
            <input type="checkbox" name="contains_mri" id="contains_mri" required/> 
            The data includes some form of MRI data.
            <br/><br/>
            </li>
            <li>
            All data must be deidentified prior to submission, with no links from 
            the dataset to the individuals who were imaged. Tools that can do this 
            include 
            <a href="https://pypi.python.org/pypi/pydeface">pydeface</a> 
            and
            <a href="https://www.nitrc.org/projects/deid/">DeID</a>
            <br/><br/>
            <input type="checkbox" name="deident" id="deident" required/> 
            The data are deidentified.
            <br/><br/>
            </li>
            <li>
            All submitted datasets need to be organized according to the 
            <a href="http://bids.neuroimaging.io/">
                Brain Imaging Data Structure (BIDS) standard
            </a>
            . Please validate your dataset before submission using the 
            <a href="http://incf.github.io/bids-validator/">
                in-browser validator
            </a>
             (requires Chrome browser, also available as a 
            <a href="http://incf.github.io/bids-validator/">command line tool</a>
            <br/><br/>
            <input type="checkbox" name="bids" id="bids" required/> 
            The data to be uploaded will be converted to the BIDS standard.
            ).
            </li>
            <br/><br/>
        </ul>
    </p>
    <p> 
        On submission a data curator will review the inormation you provide. 
        For eligible datasets we will contact the authors and provide a link 
        where additional information for the dataset can be submitted if 
        needed. 
    </p>
    <br/>
    <h5 id="check_warn">All boxes must be checked to submit a dataset</h5>
    <script type="text/javascript" src="http://assets.freshdesk.com/widget/freshwidget.js"></script>
    <style type="text/css" media="screen, projection">
    @import url(http://assets.freshdesk.com/widget/freshwidget.css);
    </style>
    <div id="contact_form_cover">
    <iframe style="title="Feedback Form" class="freshwidget-embedded-form" id="freshwidget-embedded-form" src="https://openfmri.freshdesk.com/widgets/feedback_widget/new?&widgetType=embedded&formTitle=Submit+a+new+dataset&submitThanks=Thank+you+for+your+submission!+Someone+will+get+back+to+you+shortly!&screenshot=no&searchArea=no&formTitle=Describe+your+dataset" scrolling="no" height="500px" width="100%" frameborder="0" >
    </iframe>
    </div>
{% endblock %}

{% block javascript %}
    {{ block.super }}
    <script type="text/javascript">
        var check_boxes = ['unprocessed', 'contains_mri', 'deident', 'bids']
        function validateCheckboxes() {
            var not_checked = false;
            for(var i = 0; i < check_boxes.length; i++) {
                if(!document.getElementById(check_boxes[i]).checked) {
                    not_checked = true;
                    break;
                }
            }

            if (!not_checked) {
                document.getElementById('contact_form_cover').style.opacity = 1;
                document.getElementById('contact_form_cover').style.pointerEvents = "all";
                document.getElementById('check_warn').style.display = 'none';
            } else {
                document.getElementById('contact_form_cover').style.opacity = .2;
                document.getElementById('contact_form_cover').style.pointerEvents = "none";
                document.getElementById('check_warn').style.display = 'block';
            }
        }

        for(var i = 0; i < check_boxes.length; i++) {
            var form = document.getElementById(check_boxes[i]);
            if (form.attachEvent) {
                form.attachEvent("change", validateCheckboxes);
            } else {
                form.addEventListener("change", validateCheckboxes);
            }
        }
        document.addEventListener("DOMContentLoaded", validateCheckboxes);
        </script>
{% endblock %}
